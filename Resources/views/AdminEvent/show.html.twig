{% extends 'BlackAdminBundle::base.html.twig' %}
{% block body %}

    {% include 'BlackAdminBundle:Admin:header.html.twig' %}
    {% include 'BlackAdminBundle:Admin:sidebar.html.twig' %}
    {% include 'BlackEventBundle:AdminEvent:sidebar.html.twig' %}

    {% set admin_edit = 'admin_person_edit' %}
    {% set admin_attendee_delete = 'admin_event_attendee_delete' %}

    <div id="content">

        {% include 'BlackAdminBundle:Admin:contentTop.html.twig' with {'title': "event.admin.event.sidebar.list.span"} %}
        {% include 'BlackEventBundle:AdminEvent:breadLine.html.twig' with {'route': 'admin_event_new', 'text': "event.admin.shortcut.new"} %}

        <div class="wrapper">

            {% include 'BlackAdminBundle:Admin:flashes.html.twig' with {'flashes': app.session.FlashBag()} %}

            <div class="fluid" itemscope itemtype="http://schema.org/Event">

                <div class="widget grid3">

                    <div class="whead">
                        <h6>{% trans %}Informations{% endtrans %}</h6>
                        <div class="titleOpt">
                            <a href="#" data-toggle="dropdown"><span class="icos-cog3"></span><span class="clear"></span></a>
                            <ul class="dropdown-menu pull-right">
                                <li>
                                    <a href="{{ path('admin_event_edit', { 'id': document.id }) }}" class="">
                                        <span class="icos-pencil"></span>{% trans %}event.admin.show.informations.edit{% endtrans %}
                                    </a>
                                </li>
                            </ul>
                        </div>
                        <div class="clear"></div>
                    </div>

                    <div class="body">
                        <p>
                            <span itemprop="name"><strong>{{ document.name }}</strong></span><br>
                            {% trans with {'%registered%': document.attendees|length } %}event.admin.show.informations.attendees{% endtrans %}
                        </p>

                        <div class="btn-group" style="display: inline-block; margin-bottom: -4px;">
                            <a class="buttonS bBlue" data-toggle="dropdown" href="#">{% trans %}event.admin.show.informations.export.actions{% endtrans %}<span class="caret"></span></a>
                            <ul class="dropdown-menu">
                                <li><a href="{{ url('admin_event_export_list', { 'id': document.id, 'type': 'i'}, true) }}">
                                        <span class="icos-pdf"></span>{% trans %}event.admin.show.informations.export.i{% endtrans %}</a></li>
                                <li><a href="{{ url('admin_event_export_list', { 'id': document.id, 'type': 'v'}, true) }}">
                                        <span class="icos-pdf"></span>{% trans %}event.admin.show.informations.export.v{% endtrans %}</a></li>
                                <li><a href="{{ url('admin_event_export_list', { 'id': document.id, 'type': 'iv'}, true) }}">
                                        <span class="icos-pdf"></span>{% trans %}event.admin.show.informations.export.iv{% endtrans %}</a></li>
                                <li><a href="{{ url('admin_event_export_list', { 'id': document.id }, true) }}">
                                        <span class="icos-pdf"></span>{% trans %}event.admin.show.informations.export.all{% endtrans %}</a></li>
                                <li><a href="{{ url('admin_event_export_excel', { 'id': document.id }, true) }}">
                                        <span class="icos-excel"></span>{% trans %}event.admin.show.informations.export.newsletter{% endtrans %}</a></li>
                            </ul>
                        </div>
                        <div class="clear"></div>

                    </div>

                </div>

                <div class="fluid grid9">
                    <div class="widget">
                        <div class="whead"><h6>{% trans %}Description{% endtrans %}</h6><div class="clear"></div></div>
                        <div class="body" itemprop="description">
                            {% if document.description %}
                                {{ document.description }}
                            {% else %}
                                <p class="textC">No description yet</p>
                            {% endif %}
                        </div>
                    </div>
                </div>

                <div class="clear"></div>

                <form id="validate" class="main" action="{{ path('admin_person_batch') }}" method="post">
                    <div class="fluid">
                        <div class="widget check">
                            <div class="whead">
                                <span class="titleIcon"><input type="checkbox" id="titleCheck" name="titleCheck" /></span>
                                <h6>{% trans %}event.admin.show.attendees.title{% endtrans %}</h6>
                                <div class="clear"></div>
                            </div>

                            <div id="dyn" class="hiddenpars">

                                <a class="tOptions" title="Options"><img src="/bundles/blackadmin/images/icons/options" alt="" /></a>

                                <table cellpadding="0" cellspacing="0" width="100%" class="tDefault checkAll tMedia dynamicTable" id="dynamic">
                                    <thead>
                                        <tr>
                                            <td style="width: 30px"><img src="/bundles/blackadmin/images/elements/other/tableArrows.png" alt="" /></td>
                                            <td class="sortCol"><div>{% trans %}engine.admin.person.form.name{% endtrans %}<span></span></div></td>
                                            <td class="sortCol"><div>{% trans %}engine.admin.person.form.email{% endtrans %}<span></span></div></td>
                                            <td class="sortCol"><div>{% trans %}engine.admin.person.form.works{% endtrans %}<span></span></div></td>
                                            <td class="sortCol"><div>{% trans %}engine.admin.person.form.country{% endtrans %}<span></span></div></td>
                                            <td class="sortCol"><div>{% trans %}event.admin.show.informations.export.title{% endtrans %}<span></span></div></td>
                                            <td style="width: 100px">{% trans %}admin.actions{% endtrans %}</td>
                                        </tr>
                                    </thead>

                                    <tbody>
                                    {% for attendee in document.attendees %}

                                        <tr class="{% if loop.index is odd %}odd{% else %}even{% endif %}">
                                            <td><input type="checkbox" name="ids[]" value="{{ attendee.id }}" /></td>

                                            <td class="textL"><strong>{{ attendee.name|upper }}</strong></td>
                                            <td class="textL">{{ attendee.email }}</td>
                                            <td class="textL">{{ attendee.worksFor }}</td>
                                            <td class="textL">{% if attendee.address.first %}{{ attendee.address.first.addressCountry }}{% endif %}</td>
                                            <td class="textL">
                                                {% for invitation in attendee.invitations %}
                                                    {% if document.name == invitation.event.name %}
                                                        {% if 'i' == invitation.type %}
                                                            {% trans %}event.admin.show.informations.export.i{% endtrans %}
                                                        {% elseif 'v' == invitation.type %}
                                                            {% trans %}event.admin.show.informations.export.v{% endtrans %}
                                                        {% else %}
                                                            {% trans %}event.admin.show.informations.export.iv{% endtrans %}
                                                        {% endif %}
                                                    {% endif %}
                                                {% endfor %}
                                            </td>
                                            <td class="tableActs" align="center">
                                                {% if admin_show is defined %}
                                                    <a href="{{ path(admin_show, { 'id': attendee.id }) }}" class="tablectrl_small bBlue tipS" title="{% trans %}admin.table.show{% endtrans %}">
                                                        &nbsp;<span class="iconb" data-icon="î†š">&nbsp;</span>
                                                    </a>
                                                {% endif %}

                                                {% if is_granted('ROLE_ADMIN') %}
                                                    <a href="{{ path(admin_edit, { 'id': attendee.id }) }}" class="tablectrl_small bGreen tipS" title="{% trans %}admin.table.edit{% endtrans %}">
                                                        <span class="iconb" data-icon="&#xe1db;"></span>
                                                    </a>
                                                {% endif %}

                                                <a href="{{ url(admin_attendee_delete, { 'person': attendee.id, 'event': document.id, 'token': csrf.generateCsrfToken('delete' ~ document.id) }, true) }}" class="tablectrl_small bRed tipS" title="{% trans %}admin.table.delete{% endtrans %}">
                                                    <span class="iconb" data-icon="&#xe136;"></span>
                                                </a>

                                            </td>
                                        </tr>
                                    {% else %}
                                        <tr class="{% if loop.index is odd %}odd{% else %}even{% endif %}">
                                            <td colspan="3">{% trans %}admin.noRecord{% endtrans %}</td>
                                        </tr>
                                    {% endfor %}
                                    </tbody>

                                    <tfoot>
                                    <tr>
                                        <td colspan="6">
                                            <div class="itemActions">
                                                <label>{% trans %}erp.admin.person.form.table.select.action{% endtrans %}</label>
                                                <select name="batchAction" style="opacity: 0;">
                                                    <option value="">{% trans %}erp.admin.person.form.table.select.choose{% endtrans %}</option>
                                                    <option value="bistrol">{% trans %}erp.admin.person.form.table.select.bristol{% endtrans %}</option>
                                                    <option value="envelope">{% trans %}erp.admin.person.form.table.select.envelope{% endtrans %}</option>
                                                    <option value="labels">{% trans %}erp.admin.person.form.table.select.labels{% endtrans %}</option>
                                                </select>
                                                <input type="hidden" name="token" value="{{ csrf.generateCsrfToken('batch') }}" />
                                                <input type="submit" class="buttonS bGreen" value="{% trans %}Submit{% endtrans %}" />
                                            </div>

                                        </td>
                                    </tr>
                                    </tfoot>
                                </table>
                            </div>
                        </div>
                    </div>
                </form>

            </div>
        </div>

    </div>

{% endblock %}
